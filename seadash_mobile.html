<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SeaDash – Tap to Swim!</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<style>
html,body{margin:0;padding:0;width:100%;height:100%;overflow:hidden;background:#6fd9ff;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;touch-action:none;}
#overlay{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:2em;text-shadow:0 0 8px #000;background:rgba(0,0,0,0.12);pointer-events:none;transition:opacity .4s;}
#score{position:absolute;top:calc(env(safe-area-inset-top,0) + 10px);left:50%;transform:translateX(-50%);color:#fff;font-size:1.6em;text-shadow:0 0 5px #000;}
</style>
</head>
<body>
<div id="overlay">Tap / Click / Space to swim</div>
<div id="score">0</div>
<script type="module">
// threejs import
import * as THREE from 'https://unpkg.com/three@0.160.0/build/three.module.js';
const GRAVITY=-0.0025, FLAP=0.06, FISH_R=0.5, GAP=3, SPACING=10, SPEED=0.05;
let scene,camera,renderer,fish,vy=0,pipes=[],score=0,state='waiting';
const overlay=document.getElementById('overlay'),scoreEl=document.getElementById('score');
init();animate();
function init(){scene=new THREE.Scene();scene.background=new THREE.Color(0x6fd9ff);scene.fog=new THREE.Fog(0x6fd9ff,70,150);
camera=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,0.1,300);camera.position.set(0,0,14);
renderer=new THREE.WebGLRenderer({antialias:true});renderer.setPixelRatio(devicePixelRatio);renderer.setSize(window.innerWidth,window.innerHeight);
document.body.appendChild(renderer.domElement);
scene.add(new THREE.HemisphereLight(0xdfffff,0x0077aa,1.3));const sun=new THREE.DirectionalLight(0xffffff,1);sun.position.set(7,15,4);scene.add(sun);scene.add(new THREE.AmbientLight(0xffffff,0.4));
fish=createFish();scene.add(fish);const floor=new THREE.Mesh(new THREE.PlaneGeometry(500,500),new THREE.MeshPhongMaterial({color:0x00b3cc,side:THREE.DoubleSide}));floor.rotation.x=-Math.PI/2;floor.position.y=-6.5;scene.add(floor);
for(let i=0;i<6;i++)addPipe(i*SPACING+24);window.addEventListener('resize',()=>{camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight);});
window.addEventListener('keydown',e=>{if(e.code==='Space')flap();},{passive:false});
const touch=e=>{e.preventDefault();flap();};window.addEventListener('touchstart',touch,{passive:false});
window.addEventListener('pointerdown',flap);window.addEventListener('mousedown',flap);}
function createFish(){const g=new THREE.Group();const m=new THREE.MeshStandardMaterial({color:0xfff48f,flatShading:true});g.add(new THREE.Mesh(new THREE.SphereGeometry(0.6,16,16),m));
const tail=new THREE.Mesh(new THREE.ConeGeometry(0.45,0.7,8),m);tail.rotation.z=Math.PI;tail.position.x=-0.9;g.add(tail);
const eyeM=new THREE.MeshBasicMaterial({color:0});const eye=new THREE.Mesh(new THREE.SphereGeometry(0.09,8,8),eyeM);eye.position.set(0.4,0.23,0.5);g.add(eye);const eye2=eye.clone();eye2.position.z=-0.5;g.add(eye2);return g;}
function coralMat(){const p=[0xff89c7,0xffd97d,0xe062ff,0x46eaff,0xff7a7a,0x77ffae];return new THREE.MeshStandardMaterial({color:p[p.length*Math.random()|0],flatShading:true});}
function addPipe(x){const g=new THREE.Group();g.position.x=x;const topH=Math.random()*4+2;const bottomH=12-topH-GAP;const r=1+(Math.random()*0.5-0.25);
const top=new THREE.Mesh(new THREE.CylinderGeometry(r*0.75,r,topH,6,1),coralMat());top.position.set(0,GAP/2+bottomH+topH/2,0);top.rotation.z=(Math.random()*0.4-0.2);g.add(top);
const bot=new THREE.Mesh(new THREE.CylinderGeometry(r,r*0.75,bottomH,6,1),coralMat());bot.position.set(0,-GAP/2-bottomH/2,0);bot.rotation.z=(Math.random()*0.4-0.2);g.add(bot);
scene.add(g);pipes.push(g);}
function flap(){if(state==='gameover'){reset();return;}if(state==='waiting'){state='running';overlay.style.opacity=0;setTimeout(()=>overlay.style.display='none',400);}if(state==='running')vy=FLAP;}
function animate(){requestAnimationFrame(animate);if(state==='running')update();renderer.render(scene,camera);}
function update(){vy+=GRAVITY;fish.position.y+=vy;fish.rotation.z=-vy*9;camera.position.y=THREE.MathUtils.lerp(camera.position.y,fish.position.y,0.08);
const sphere=new THREE.Sphere(fish.position.clone(),FISH_R);for(let i=pipes.length-1;i>=0;i--){const g=pipes[i];g.position.x-=SPEED;if(g.position.x<-22){scene.remove(g);pipes.splice(i,1);const far=Math.max(...pipes.map(p=>p.position.x),0);addPipe(far+SPACING);continue;}
if(!g.userData.scored&&g.position.x<fish.position.x-1){g.userData.scored=true;score++;scoreEl.textContent=score;}
for(const coral of g.children){coral.geometry.computeBoundingBox();const box=coral.geometry.boundingBox.clone().applyMatrix4(coral.matrixWorld);if(box.intersectsSphere(sphere)){gameOver();return;}}}
if(fish.position.y<-6.5||fish.position.y>8)gameOver();}
function gameOver(){state='gameover';overlay.textContent='Game Over – score '+score+' (tap to retry)';overlay.style.display='flex';overlay.style.opacity=1;}
function reset(){pipes.forEach(p=>scene.remove(p));pipes.length=0;for(let i=0;i<6;i++)addPipe(i*SPACING+24);fish.position.set(0,0,0);vy=0;score=0;scoreEl.textContent=0;camera.position.y=0;overlay.textContent='Tap / Click / Space to swim';overlay.style.display='flex';overlay.style.opacity=1;state='waiting';}
</script>
</body>
</html>